---
title: Explorative Datenanalyse von Fahrraddiebstähle
---


# 1. Herkunft der Daten

Die zugrunde liegenden Daten wurden in einer [Online-Umfrage](https://thebestbikelock.com/win-free-bike-competition/)
im November 2021 erhoben.
Das Ziel dieser Umfrage ist es, das Ausmaß von Fahrraddiebstahl in Nordamerika, Europa und dem Vereinigten Königreich
einschätzen zu können.

Die Umfrage umfasst 12 Fragen, welche hier unverändert in der aufgelistet sind.
Bei der Auswahl der Antwort-Möglichkeiten "Other" beziehungsweise "Others" wird zusätzlich gewünscht, diese Antwort als
Freitext zu spezifizieren.
Eine Verifizierung der Eingabe bietet das Formular nicht.
So ist es beispielsweise möglich anzugeben, das Fahrrad wäre gleichzeitig abgesichert und nicht abgesichert gewesen.

[](@formatter:off)

------------------------------------------------------------------------------------------------------------------------
Frage                                               Antwort-Möglichkeiten                  Mehrfachauswahl Verpflichtend
--------------------------------------------------- -------------------------------------- --------------- -------------
How many times has your bike been stolen since you  Never<br>                              Nein            Ja
started cycling?                                    1<br>
                                                    2<br>
                                                    3<br>
                                                    4<br>
                                                    5<br>
                                                    6 times or more

Where was the last bike stolen from?                Street<br>                             Nein            Nein
                                                    Front garden / yard<br>
                                                    Back garden / yard<br>
                                                    Shed<br>
                                                    Garage<br>
                                                    Inside home<br>
                                                    Work or Public Authority
                                                    bike<br>
                                                    parking

What was the bike secured with?                     It wasn’t locked<br>                   Ja              Nein
                                                    Cable lock<br>
                                                    U-lock / D-lock<br>
                                                    Chain lock<br>
                                                    Folding lock

What security rating did the primary lock have?     Don't know<br>                         Nein            Nein
                                                    None<br>
                                                    Sold Secure Bronze<br>
                                                    Sold Secure Silver<br>
                                                    Sold Secure Gold<br>
                                                    Sold Secure Diamond<br>
                                                    Other

How much did you spend on your locks?               Less than 20<br>                       Nein            Nein
                                                    20 - 40<br>
                                                    41 - 60<br>
                                                    61 - 100<br>
                                                    More than 100

What was the approximate value of the bike?         Less than 100<br>                      Nein            Nein
                                                    100 - 400<br>
                                                    401 - 700<br>
                                                    701 - 1000<br>
                                                    Over 1000

Did you have a record of the frame number of the    Yes<br>                                Nein            Nein
bike?                                               No

Did you report the stolen bike to the police?       Yes<br>                                Nein            Nein
                                                    No

Did you get the stolen bike back?                   Yes<br>                                Nein            Nein
                                                    No

How many times have components (wheels, seats,      Never<br>                              Nein            Ja
brakes etc) been stolen from your bike?             1<br>
                                                    2<br>
                                                    3<br>
                                                    4<br>
                                                    5<br>
                                                    6 times or more<br>

Which components have been stolen?                  Wheels<br>                             Ja              Nein
                                                    Seats<br>
                                                    Handlebars<br>
                                                    Headset<br>
                                                    Forks<br>
                                                    Brakes<br>
                                                    Gears<br>
                                                    Lights<br>
                                                    Others

What was the last stolen component attached /       Quick release clamp only<br>           Nein            Nein
secured with?                                       Quick release clamp plus
                                                    cable<br>
                                                    Hex bolt or Standard nut only<br>
                                                    Hex bolt or Standard nut plus
                                                    cable<br>
                                                    Security skewers / nuts (Pinhead,
                                                    Pitlock, Hexlox etc)<br>
                                                    Any other type of secondary bike
                                                    lock
------------------------------------------------------------------------------------------------------------------------

[](@formatter:on)

Als Belohnung wurde den ersten 5000 Teilnehmern eine Gewinnchance auf ein Fahrrad im Wert von bis zu 600 $ in
Aussicht gestellt.
Eine Mehrfachteilnahme wird nicht verhindert, weshalb es nahe liegt, dass einzelne Teilnehmer mehrfach die Umfrage
beantworten, um ihre Gewinnchancen zu steigern.

Neben den Antworten auf die Fragen enthält der Datensatz den Standort der Teilnehmer.
Da diese nicht explizit vom Teilnehmer angegeben wird, handelt es sich wahrscheinlich um eine grobe Bestimmung anhand
der IP-Adresse statt einer exakten Methode.

# 2. Einlesen der Daten

Die Daten liegen in einer Excel-Datei vor, welche als Spaltennamen die jeweiligen Fragen verwendet.
Für eine bessere Handhabung werden die Spaltennamen durch Umbenennen vereinfacht.

```{r}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(dplyr)

data_source <- './Data_With_Geolocations_stud.xlsx'
sheet_name <- 'Geolocation expanded'

data <- read_excel(data_source, sheet = sheet_name) %>%
  rename(
    bike_stolen_frequency = 'How many times has your bike been stolen since you started cycling?',
    place_of_last_bike_theft = 'Where was the last bike stolen from?',
    bike_securing_method = 'What was the bike secured with?',
    bike_lock_rating = 'What security rating did the primary lock have?',
    other_lock_rating = 'Please specify the other security rating...',
    bike_lock_cost = 'How much did you spend on your locks?',
    bike_cost = 'What was the approximate value of the bike?',
    frame_number_record = 'Did you have a record of the frame number of the bike?',
    police_report = 'Did you report the stolen bike to the police?',
    bike_retrived = 'Did you get the stolen bike back?',
    components_stolen_frequency = 'How many times have components (wheels, seats, brakes etc) been stolen from your bike?',
    components_stolen = 'Which components have been stolen?',
    other_components_stolen_description = 'Please specify the other components...',
    component_securing_method = 'What was the last stolen component attached / secured with?',
    location_description = 'Geolocation Details',
    location_latitude = 'Latitude',
    location_longitude = 'Longitude',
    location_country = 'Country',
    location_city = 'City'
  )

str(data)
```

# 3. Aufbereitung

Alle gewählten Antworten bei Fragen mit Mehrfachauswahl befinden sich in der gleichen Spalte.
Um die Qualität der Daten zu verbessern, wird für jede Option einer Mehrfachauswahl eine weitere Spalte abgeleitet.

```{r}
library(stringr)
library(purrr)

check_multi_selection <- function(method, column) {
  if_else(
    is.na(column),
    NA,
    if_else(
      map_lgl(str_split(column, '\r\n'), ~method %in% .x),
      'Yes',
      'No'
    )
  )
}

data <- data %>%
  mutate(
    bike_not_locked = check_multi_selection('It wasn’t locked', bike_securing_method),
    bike_cable_lock = check_multi_selection('Cable lock', bike_securing_method),
    bike_u_d_lock = check_multi_selection('U-lock / D-lock', bike_securing_method),
    bike_chain_lock = check_multi_selection('Chain lock', bike_securing_method),
    bike_folding_lock = check_multi_selection('Folding lock', bike_securing_method),
    wheels_stolen = check_multi_selection('Wheels', components_stolen),
    seats_stolen = check_multi_selection('Seats', components_stolen),
    handlebars_stolen = check_multi_selection('Handlebars', components_stolen),
    headset_stolen = check_multi_selection('Headset', components_stolen),
    forks_stolen = check_multi_selection('Forks', components_stolen),
    breaks_stolen = check_multi_selection('Breaks', components_stolen),
    gears_stolen = check_multi_selection('Gears', components_stolen),
    lights_stolen = check_multi_selection('Lights', components_stolen),
    other_components_stolen = check_multi_selection('Others', components_stolen),
  )

str(data)
```

# 4. Quantitative Betrachtung der Teilnahmen

Da die Umfragedaten keine Rückschlüsse auf die Teilnehmer zulassen, lassen sich lediglich die Teilnahmen betrachten.
Eine mehrfache Teilnahme lässt sich nicht eindeutig identifizieren.

> Wie viele Antworten auf die Umfrage wurden abgegeben?

```{r, fig.width=10}
library(ggplot2)

donut_diagram <- function(data, values, fill, annotation) {
  donut_diameter <- 2.5

  ggplot(data, aes(x = donut_diameter, y = values, fill = fill)) +
    geom_col() +
    geom_text(aes(label = values), position = position_stack(vjust = 0.5), color = 'white') +
    coord_polar(theta = "y") +
    xlim(c(0.2, donut_diameter + 0.5)) +
    theme(
      panel.background = element_rect(fill = 'white', color = 'white'),
      axis.title = element_blank(),
      axis.text = element_blank(),
      axis.ticks = element_blank()
    ) +
    annotate(
      'text',
      label = annotation,
      fontface = 'bold',
      color = 'black',
      size = 16,
      x = 0.3,
      y = 0
    )
}

total_count <- nrow(data)
unique_count <- data %>% unique() %>% nrow()

submission_counts <- data.frame(
  count = c(unique_count, total_count - unique_count),
  group = c("Yes", "No")
)

submission_counts %>%
  donut_diagram(values = submission_counts$count, fill = submission_counts$group, annotation = total_count) +
  labs(
    title = 'Anzahl der Teilnahmen',
    fill = 'Einzigartig'
  )
```

Die Doppelnennungen können zufällig entstehen, da ein Teilnehmer die gleiche Erfahrung gemacht haben kann wie ein
anderer.
Der Anteil dieser Antworten liegt bei unter 2 %, weshalb hier keine genauere Betrachtung benötigt wird und im
restlichen Notebook der volle Datensatz verwendet wird.

# 5. Geographische Auswertung der Teilnahmen

> Aus wie vielen Länder kommen die Teilnahmen?

```{r}
data %>%
  select(location_country) %>%
  unique() %>%
  filter(!is.na(location_country)) %>%
  nrow()
```

Das Ergebnis ist als Mindestanzahl zu verstehen, da Teilnahmen nicht immer einem Land zugeordnet werden können und
gegebenenfalls aus weiteren Länder getätigt worden sind.

> Aus welchen Regionen kommen die Teilnahmen?

```{r, fig.width=10,fig.height=6.25}
library(maps)

world_map <- map_data('world')

ggplot() +
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +
  theme(
    panel.background = element_rect(fill = 'white', color = 'black'),
    axis.line = element_line(color = 'black'),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  ) +
  geom_point(
    data = data,
    aes(x = as.numeric(location_longitude), y = as.numeric(location_latitude)),
    color = 'Deep Pink',
    fill = 'Pink',
    pch = 21,
    size = 2,
    alpha = I(0.5)
  ) +
  labs(
    title = 'Orte der Teilnahmen',
    caption = 'Ein Marker entspricht eine Teilnahme.',
  )
```

> Welche Regionen sind am meisten vertreten?

```{r, fig.width=10,fig.height=5}
library(treemapify)

submissions_per_region <- data %>%
  group_by(location_country, location_city) %>%
  summarize(region_count = n())

top_countries <- submissions_per_region %>%
  filter(!is.na(location_country)) %>%
  group_by(location_country) %>%
  summarize(country_count = sum(region_count)) %>%
  arrange(desc(country_count)) %>%
  top_n(5) %>%
  select(location_country)

country_city_distrubition <- function(region_counts, country) {
  country_regions <- region_counts %>%
    filter(location_country == country, !is.na(location_city))

  top_region_counts <- country_regions %>%
    arrange(desc(region_count)) %>%
    top_n(5)

  other_region_combined_count <- country_regions %>%
    filter(!(location_city %in% top_region_counts$location_city)) %>%
    summarize(region_count = sum(region_count), location_city = 'Other')

  bind_rows(top_region_counts, other_region_combined_count)
}

top_regions_per_top_country <- bind_rows(
  top_countries$location_country %>% map_df(\(x) country_city_distrubition(submissions_per_region, x)),
  data %>%
    filter(!(location_country %in% top_countries$location_country)) %>%
    summarize(region_count = n(), location_city = 'Other', location_country = 'Other')
)

ggplot(
  top_regions_per_top_country,
  aes(area = region_count, fill = location_country, subgroup = location_country, label = location_city)
) +
  geom_treemap() +
  geom_treemap_text(colour = 'white', place = 'centre', grow = FALSE) +
  labs(
    title = 'Regionen mit den meisten Teilnahmen',
    caption = 'Die Flächen der Teile entspricht der Anzahl der Teilnahmen.',
    fill = 'Land'
  )
```

Da gerade einmal etwa ein Fünftel der Teilnahmen keine Diebstähle angeben, lässt sich ein Selection-Bias vermuten.
Bei einer öffentlichen Onlineumfrage handelt es sich nicht immer um eine randomisierte Stichprobe.
Es ist denkbar, dass Teilnehmer, die Diebstahl erlebt haben, ein größeres Interesse aufweisen und dadurch
überproportional vertreten sind.


# 6. Unstimmigkeiten in den Daten

Da wie genannt das Formular der Umfrage keine hinreichende Validierung durchführt, treten Widersprüche in den Daten
auf.
Um widerspruchslose Aussagen zu treffen können, werden die problematischen Daten bei der Auswertung ausgeschlossen.

> Wie viele Fahrräder sind zu ihrem Besitzer zurückgekommen, und wie viele davon wurden davor nie gestohlen?

```{r, fig.width=10}
stolen_never_stolen <- function(data, stated_condition, frequency) {
  data %>%
    mutate(frequency = map_chr(frequency, \(x) if_else(x == 'Never', 'No', 'Yes'))) %>%
    filter(stated_condition) %>%
    group_by(frequency) %>%
    summarize(submission_count = n())
}

retrieved_bikes <- data %>%
  stolen_never_stolen(
    stated_condition = data$bike_retrived == 'Yes',
    frequency = data$bike_stolen_frequency
  )

retrieved_bikes %>%
  donut_diagram(
    values = retrieved_bikes$submission_count,
    fill = retrieved_bikes$frequency,
    annotation = retrieved_bikes %>% summarize(submission_count = sum(submission_count))
  ) +
  labs(
    title = 'Anzahl der zurückerhaltenen Fahrräder',
    fill = 'Fahrrad gestohlen'
  )
```

> In wie vielen Fällen wurden Komponenten als gestohlen angegeben, ohne gestohlen worden zu sein?

```{r, fig.width = 10}
stolen_components <- data %>%
  stolen_never_stolen(
    stated_condition = !is.na(data$components_stolen),
    frequency = data$components_stolen_frequency
  )

stolen_components %>%
  donut_diagram(
    values = stolen_components$submission_count,
    fill = stolen_components$frequency,
    annotation = stolen_components %>% summarize(submission_count = sum(submission_count))
  ) +
  labs(
    title = 'Anzahl der Teilnahmen mit als geklaut angegebene Komponenten',
    fill = 'Komponente gestohlen',
    caption = 'Anzahl der Teilnahmen welche als mindestens eine Komponente als gestohlen angeben.'
  )
```

# 7. Ausmaß der Diebstähle

```{r, fig.width = 10, fig.height = 8}
data %>%
  group_by(bike_stolen_frequency, components_stolen_frequency) %>%
  summarize(
    submission_count = n(),
    bike_frequency_order = if_else(bike_stolen_frequency == 'Never', '0', bike_stolen_frequency),
    components_frequency_order = if_else(components_stolen_frequency == 'Never', '0', components_stolen_frequency)
  ) %>%
  ggplot(aes(x = bike_frequency_order, y = components_frequency_order, fill = submission_count)) +
  geom_tile(color = 'white', lwd = 1.5, linetype = 1) +
  geom_text(aes(label = submission_count), color = 'white', size = 4) +
  coord_fixed() +
  scale_fill_gradient(low = "grey", high = "Deep Pink") +
  theme(
    panel.background = element_rect(fill = 'white', color = 'white'),
    axis.line = element_line(color = 'white'),
    axis.ticks = element_blank(),
    axis.title.y = element_text(margin = margin(r = 10)),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
    legend.position = 'none'
  ) +
  labs(
    title = 'Anzahl der Teilnahmen pro Anzahl der erlebte Diebstähle',
    y = 'Anzahl der erlebten Komponentendiebstähle',
    x = 'Anzahl der erlebten Fahrraddiebstähle'
  )
```